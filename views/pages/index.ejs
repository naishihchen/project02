<html lang="en">
	<head>
		<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
		<meta content="utf-8" http-equiv="encoding">
		<link rel="stylesheet" type="text/css" href="styles.css" />
		<link href="https://fonts.googleapis.com/css2?family=Lato&display=swap" rel="stylesheet">
	</head>
	<body>
		<div id="photoDisplay">
			<p>Search for a photo on a specific day! Please use the format 'yyyy-mm-dd'</p>
			<p>NASA's Photo Of The Day started on June 16th, 1995, so please pick a date on or afterwards.</p>
			<div id="search-container">
				<input type="text" id="searchbar">
			</div>
			<div id="buttons">
				<button id='search'>Get My Photo</button>
			</div>
			<div id="card-face">
					<img src="image-placeholder.png" id="spacePhoto" alt="space photo"> 
			</div>
		</div>
	</body>
	<script>
		const searchButton = document.getElementById('search');
		const outputDiv = document.getElementById('card-face');
		const spacePhoto = document.getElementById('spacePhoto');

		function wait(callback){ setTimeout(callback, 2000);}

			function clearOutput() {
				outputDiv.innerHTML = "";
			}

			//This is the button that loads the picture. By putting all our set up in here, we also ensure that the date can be randomized and the API called multiple times without refreshing the page, making the program truly dynamic.
			searchButton.addEventListener('click', () => {

				//Creating a random date.
				var date = new Date(+(new Date()) - Math.floor(Math.random()*100000000000));
				console.log(date);

				//Setting the proper format that the API requires.
				var spaceDate = date.toISOString().substr(0, 10);

				//Preparing the API request, using our api key and our random date. It took me a little while to figure out API keys.
				const spaceURL = 'https://api.nasa.gov/planetary/apod?api_key=Aj3aZZ1ZX9H5YfwheMgVWGyYVwghvILvpOU9MGvt&date=' + spaceDate;

				//Setting our output clear on a timer.
				wait(clearOutput);

				//Getting the data from NASA's API
				fetch(spaceURL) 
				.then( response => { outputDiv.innerHTML = "Photo loading..."; 
					if(response.ok) { return response; } 
					throw Error(response.statusText); }) .then( response => response.json() ) 
				.then( data => spacePhoto.src = data.url ) 
				.catch( error => console.log('There was an error:', error)) },false);
	</script>
</html>